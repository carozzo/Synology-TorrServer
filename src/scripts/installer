#!/bin/sh

TEMP_DIR="${SYNOPKG_TEMP_UPGRADE_FOLDER}/db"

MV="/bin/mv -f"
RM="/bin/rm -r"
MKDIR="/bin/mkdir -p"
SED="/bin/sed -i -e"

preinst ()
{
exit 0
}

postinst ()
{
    if [ "${wizard_enable_aut}" == "false" ]; then
       ${RM} ${SYNOPKG_PKGDEST}/db/accs.db
    else
       ${SED} "s|@user@|${wizard_username:=admin}|g" ${SYNOPKG_PKGDEST}/db/accs.db
       ${SED} "s|@password@|${wizard_password:=admin}|g" ${SYNOPKG_PKGDEST}/db/accs.db
    fi
exit 0
}

preuninst ()
{
exit 0
}

postuninst ()
{
exit 0
}

preupgrade ()
{
    if [ "${wizard_update_data}" == "false" ]; then
        $RM ${TEMP_DIR}
        $MKDIR ${TEMP_DIR}
        $MV ${SYNOPKG_PKGDEST}/db/* ${TEMP_DIR}
    else
        exit 0
    fi
exit 0
}

postupgrade ()
{
    if [ "${wizard_update_data}" == "false" ]; then
        $RM ${SYNOPKG_PKGDEST}/db
        $MV ${TEMP_DIR} ${SYNOPKG_PKGDEST}
        $RM ${TEMP_DIR}
        else
        $RM ${ACCS_FILE}
    fi
exit 0
}

