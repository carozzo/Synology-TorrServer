#!/bin/sh

TEMP_DIR="${SYNOPKG_TEMP_UPGRADE_FOLDER}/db"

preinst ()
{
exit 0
}

postinst ()
{
    if [ "${wizard_enable_aut}" == "false" ]; then
       rm -r ${SYNOPKG_PKGDEST}/db/accs.db
    else
       sed -i -e "s|@user@|${wizard_username:=admin}|g" ${SYNOPKG_PKGDEST}/db/accs.db
       sed -i -e "s|@password@|${wizard_password:=admin}|g" ${SYNOPKG_PKGDEST}/db/accs.db
    fi
exit 0
}

preuninst ()
{
exit 0
}

postuninst ()
{
exit 0
}

preupgrade ()
{
    if [ "${wizard_update_data}" == "false" ]; then
        rm -r ${TEMP_DIR}
        mkdir -p ${TEMP_DIR}
        cp -r ${SYNOPKG_PKGDEST}/db/* ${TEMP_DIR}
    else
        exit 0
    fi
exit 0
}

postupgrade ()
{
    if [ "${wizard_update_data}" == "false" ]; then
        rm -r ${SYNOPKG_PKGDEST}/db
        cp -r ${TEMP_DIR} ${SYNOPKG_PKGDEST}
        rm -r ${TEMP_DIR}
        else
        rm -r ${SYNOPKG_PKGDEST}/db/accs.db
    fi
exit 0
}
